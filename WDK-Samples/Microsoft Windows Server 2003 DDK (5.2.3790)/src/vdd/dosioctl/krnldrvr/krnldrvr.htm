<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=windows-
1252">
<META NAME="Generator" CONTENT="Microsoft Word 97">
<TITLE>Krnldrvr</TITLE>
</HEAD>
<BODY LINK="#0000ff">

<FONT FACE="Verdana" SIZE=5><H2>Krnldrvr</H2>
</FONT><FONT FACE="Verdana" SIZE=2>
<P><span style="color:#FF0000;font-size:10pt;font-family:Arial">[This is preliminary
documentation and subject to change.]</span></P>

<H3>SUMMARY</H3></FONT><FONT FACE="Verdana" SIZE=2><P>
This is the Microsoft&#174; Windows NT&#174; kernel driver component of the DOSIOCTL sample.<P>

This kernel driver's sole responsibility is to respond to a single IOCTL and return a fixed DWORD of information. The interesting trick is that this driver places the DWORD directly in the buffer of a DOS application.<P>

This is accomplished by using a DOS driver and a VDD. An IOCTL read is issued from the DOS application, and the pointer supplied in that request is passed along to this driver. Note that the IOCTL used is <I>buffered</I>, so the I/O subsystem need only do a single copy.<P>

The data passed here is the DWORD 0x12345678. This data will then be displayed by the DOS application.<P>

The drivers supplied in this sample are only skeletons, but having the working communication mechanism in place provides a good starting point for building a new driver.<P>

<H3>BUILDING THE SAMPLE</H3></FONT><FONT FACE="Verdana"
SIZE=2><P>

To build this sample, enter the free or checked build environment and run <B>build</B>
from the \\Ntddk\Vdd\Dosioctl\Krnldrvr directory. A successful build  produces the
binary Krnldrvr.sys.<P>

<H3>TESTING THE SAMPLE</H3></FONT><FONT FACE="Verdana"
SIZE=2><P>

To test this sample, please refer to the <B>test.cmd</B> file under
\\Ntddk\Vdd\Dosioctl directory.<P>



<H3>CODE TOUR</H3>
<H4>File Manifest</H4>
</FONT><U><PRE>File&#9;&#9;Description
</U>
Krnldrvr.htm&#9;The documentation for these samples (this file)
Sources&#9;     The generic file for building the code sample
Makefile&#9;Drivers makefile
Krnldrvr.c&#9;The sample source for Krnldrvr
Krnldrvr.h&#9;The header file for Krnldrvr.c source
Krnldrvr.rc&#9;The resource file for Krnldrvr.c source
<P>
</FONT><P ALIGN="CENTER"><A HREF="#top"><FONT FACE="Verdana" SIZE=2>Top of page</FONT></A><FONT FACE="Verdana" SIZE=2> </P></FONT>
<TABLE CELLSPACING=0 BORDER=0 WIDTH=624>
<TR><TD VALIGN="MIDDLE" BGCOLOR="#00ffff" HEIGHT=2>
<P></TD>
</TR>
</TABLE>

<FONT FACE="MS Sans Serif" SIZE=1><P>&copy; 1999 Microsoft Corporation</FONT><FONT FACE="Verdana" SIZE=2> </P></FONT></BODY>
</HTML>

